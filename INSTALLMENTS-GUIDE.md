# دليل استخدام نظام إدارة أموال المدارس - الأقساط والطلاب

## المميزات الجديدة

### 1. صفحة تفاصيل الطالب (`/dashboard/students/[id]`)

#### الوظائف المتاحة:
- **عرض معلومات الطالب الكاملة**: الاسم، المدرسة، الصف، الشعبة، تاريخ التسجيل
- **إحصائيات مالية شاملة**:
  - القسط الكلي المطلوب
  - إجمالي المبلغ المدفوع
  - المبلغ المتبقي
  - عدد الأقساط المدفوعة

#### إدارة الأقساط:
- **إضافة قسط جديد**:
  - إدخال مبلغ القسط
  - التحقق من عدم تجاوز المبلغ المتبقي
  - حفظ تاريخ ووقت الدفع بدقة
  - إنشاء رقم إيصال مميز ومتسلسل

- **إدارة الأقساط الموجودة**:
  - عرض جميع الأقساط مع تواريخها
  - إمكانية حذف أي قسط
  - طباعة إيصال مفصل لكل قسط

#### نظام الطباعة:
- **محتوى الإيصال المطبوع**:
  - رقم الإيصال المميز
  - تفاصيل الطالب كاملة (الاسم، المدرسة، الصف، الشعبة)
  - القسط الكلي
  - المبلغ المدفوع في هذا الإيصال
  - إجمالي المدفوع حتى تاريخه
  - المبلغ المتبقي
  - تاريخ ووقت الدفع
  - مساحة للتوقيع

### 2. صفحة الأقساط المحدثة (`/dashboard/installments`)

#### العرض الشامل:
- **عرض جميع الأقساط**: من جميع الطلاب في مكان واحد
- **معلومات مفصلة لكل قسط**:
  - رقم الإيصال المميز
  - اسم الطالب صاحب القسط
  - المدرسة والصف والشعبة
  - مبلغ القسط
  - تاريخ ووقت الدفع بالتفصيل

#### البحث والتصفية:
- **البحث المتقدم** بناءً على:
  - اسم الطالب
  - رقم الإيصال
  - الصف
  - اسم المدرسة

#### الإحصائيات:
- إجمالي عدد الأقساط
- عدد الأقساط المعروضة حسب البحث
- إجمالي المبلغ للأقساط المعروضة

#### التنقل السريع:
- الضغط على "عرض التفاصيل" ينقل مباشرة لصفحة تفاصيل الطالب

### 3. تحديثات صفحة إدارة الطلاب (`/dashboard/students`)

#### إضافة رابط جديد:
- زر **"التفاصيل"** في جدول الطلاب
- ينقل مباشرة لصفحة تفاصيل الطالب المحددة

### 4. نظام ترقيم الأقساط

#### الرقم المميز:
- **رقم متسلسل فريد** لكل قسط
- **لا يتكرر أبداً** حتى لو تم حذف أقساط
- **يبدأ من 1** ويزيد تلقائياً
- **يحفظ في قاعدة البيانات** كجزء من بيانات القسط

## التقنيات المستخدمة

### قاعدة البيانات (Firestore):
- **مجموعة جديدة**: `installments`
- **الحقول**:
  - `installmentNumber`: رقم الإيصال المميز
  - `studentId`: معرف الطالب
  - `studentName`: اسم الطالب (للبحث السريع)
  - `amount`: مبلغ القسط
  - `createdAt`: تاريخ ووقت الإنشاء
  - `notes`: ملاحظات إضافية

### الأمان:
- **قواعد Firestore** محدثة لتشمل مجموعة الأقساط
- **التحقق من صحة البيانات** قبل الحفظ
- **منع دفع مبالغ تتجاوز** المطلوب

### واجهة المستخدم:
- **تصميم متجاوب** يعمل على جميع الأجهزة
- **ألوان وتدرجات جميلة** للإحصائيات
- **أنيميشن خفيف** للتفاعلات
- **طباعة محسنة** للإيصالات

## طريقة الاستخدام

### لإضافة قسط لطالب:
1. اذهب لصفحة إدارة الطلاب
2. اضغط على "التفاصيل" للطالب المطلوب
3. اضغط على "إضافة قسط"
4. أدخل مبلغ القسط (لا يمكن أن يتجاوز المتبقي)
5. اضغط "إضافة القسط"

### لطباعة إيصال:
1. في صفحة تفاصيل الطالب، اضغط "طباعة" أمام القسط المطلوب
2. ستفتح نافذة جديدة مع الإيصال منسقاً للطباعة
3. استخدم Ctrl+P أو زر الطباعة في المتصفح

### لعرض جميع الأقساط:
1. اذهب لصفحة الأقساط من القائمة الجانبية
2. استخدم مربع البحث للبحث عن قسط محدد
3. اضغط "عرض التفاصيل" للانتقال لصفحة الطالب

### لحذف قسط:
1. في صفحة تفاصيل الطالب
2. اضغط "حذف" أمام القسط المطلوب
3. أكد الحذف في الرسالة التي ستظهر

## الملاحظات المهمة

### الأمان:
- لا يمكن دفع مبلغ أكبر من المتبقي
- رقم الإيصال لا يتكرر أبداً
- جميع العمليات تتطلب تسجيل دخول

### الأداء:
- البيانات تُحمل بشكل تفاعلي
- البحث يعمل فورياً أثناء الكتابة
- الصفحات محسنة للسرعة

### التوافق:
- يعمل على جميع المتصفحات الحديثة
- متجاوب مع الهواتف والأجهزة اللوحية
- يدعم الطباعة بجودة عالية

---

## المطورين

للمطورين الذين يريدون إضافة مميزات جديدة:

### إضافة حقول جديدة للأقساط:
1. حدث `Installment` interface في `src/types/index.ts`
2. حدث النماذج في صفحة تفاصيل الطالب
3. حدث قواعد Firestore إذا لزم الأمر

### إضافة تقارير جديدة:
1. استخدم `collection()` و `query()` من Firestore
2. استخدم `formatCurrency()` و `formatDate()` للتنسيق
3. اتبع نفس نمط الجداول الموجودة

### تخصيص التصميم:
- ملف الأنماط المخصصة في `src/styles/custom.css`
- استخدم Tailwind CSS للتنسيق السريع
- اتبع نظام الألوان الموجود
